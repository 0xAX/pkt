-module(pkt_tests).

-include_lib("pkt/include/pkt.hrl").
-include_lib("eunit/include/eunit.hrl").

pkt_test_() ->
    [
        pkt_decapsulate()
    ].

pkt_decapsulate() ->
    Frame = <<224,105,149,59,163,24,0,22,182,181,62,198,8,0,69,0,0,54,2,108,64,
              0,53,6,172,243,173,192,82,195,192,168,213,54,0,80,143,166,75,154,
              212,181,116,33,53,92,128,24,0,126,60,199,0,0,1,1,8,10,92,104,96,
              16,22,69,237,136,137,0>>,

    ?_assertEqual(
        [{ether,<<224,105,149,59,163,24>>,
                <<0,22,182,181,62,198>>,
                2048,0},
         {ipv4,4,5,0,54,620,1,0,0,53,6,44275,
               {173,192,82,195},
               {192,168,213,54},
               <<>>},
         {tcp,80,36774,1268438197,1948333404,8,0,0,0,1,1,0,0,0,126,
              15559,0,
              <<1,1,8,10,92,104,96,16,22,69,237,136>>},
         <<137,0>>],
        pkt:decapsulate(Frame)
    ).
